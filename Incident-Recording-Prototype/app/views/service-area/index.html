{% extends "layout_unbranded.html" %}

{% block page_title %}
Service Area
{% endblock %}

{% block content %}

<main id="content" role="main">
    <div class="grid-row">
        <div class="column-two-thirds">
            <a class="link-back" href="/patient/gender">Back</a>

            <form class="form" action="/check-your-answers" method="post">
                <div class="form-group">
                    <h1 class="heading-medium">In which service area did the incident occur?
                        <span class="form-hint">Select one</span>
                    </h1>

                    <select  class="form-control form-control-3-4 enableChosen" id="service-area" name="service-area">
                        <option>Select a service area</option>
                        {% for serviceArea in serviceAreas %}
                            <option>{{serviceArea.name}}</option>
                        {% endfor %}
                    </select>
                </div>

                <div class="form-group">
                    <h1 class="heading-medium">In which sub area did the incident occur?
                        <span class="form-hint">Select one</span>
                    </h1>

                    <select  class="form-control form-control-3-4 enableChosen" id="sub-service-area" name="sub-service-area">
                        <option>Select a sub service area</option>
                    </select>
                </div>

                <div class="form-group">
                    <input class="button" type="submit" value="Continue">
                </div>

            </form>

        </div>
    </div>

    <script type="text/javascript">
        $(document).ready(function(){
            $(".enableChosen").chosen({
                inherit_select_classes: true,
                placeholder_text_single: 'Select one',
                width: 'none' // this breaks it on purpose so css takes over for responsive design
            });

            $("#service-area").change(function () {
                $('#sub-service-area')
                    .find('option')
                    .remove();
                $.ajax({
                    url: "/get-sub-service-area/" + $(this).val()
                }).done(function (data) {

                    $('#sub-service-area').html('');
                    $.each(data, function (index, subArea) {
                        $('#sub-service-area').append($("<option>", {"text": subArea}))
                    });

                    $('#sub-service-area').trigger('chosen:updated');

                })
            })
        });
        
        
    </script>
</main>

{% endblock %}
